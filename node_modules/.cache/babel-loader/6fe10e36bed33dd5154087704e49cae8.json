{"ast":null,"code":"var assert = require('assert');\n\nvar keccak256 = require('js-sha3').keccak256;\n\nfunction libraryHashPlaceholder(input) {\n  return '$' + keccak256(input).slice(0, 34) + '$';\n}\n\nvar linkBytecode = function (bytecode, libraries) {\n  assert(typeof bytecode === 'string');\n  assert(typeof libraries === 'object'); // NOTE: for backwards compatibility support old compiler which didn't use file names\n\n  var librariesComplete = {};\n\n  for (var libraryName in libraries) {\n    if (typeof libraries[libraryName] === 'object') {\n      // API compatible with the standard JSON i/o\n      for (var lib in libraries[libraryName]) {\n        librariesComplete[lib] = libraries[libraryName][lib];\n        librariesComplete[libraryName + ':' + lib] = libraries[libraryName][lib];\n      }\n    } else {\n      // backwards compatible API for early solc-js versions\n      var parsed = libraryName.match(/^([^:]+):(.+)$/);\n\n      if (parsed) {\n        librariesComplete[parsed[2]] = libraries[libraryName];\n      }\n\n      librariesComplete[libraryName] = libraries[libraryName];\n    }\n  }\n\n  for (libraryName in librariesComplete) {\n    var hexAddress = librariesComplete[libraryName];\n\n    if (hexAddress.slice(0, 2) !== '0x' || hexAddress.length > 42) {\n      throw new Error('Invalid address specified for ' + libraryName);\n    } // remove 0x prefix\n\n\n    hexAddress = hexAddress.slice(2);\n    hexAddress = Array(40 - hexAddress.length + 1).join('0') + hexAddress; // Support old (library name) and new (hash of library name)\n    // placeholders.\n\n    var replace = function (name) {\n      // truncate to 37 characters\n      var truncatedName = name.slice(0, 36);\n      var libLabel = '__' + truncatedName + Array(37 - truncatedName.length).join('_') + '__';\n\n      while (bytecode.indexOf(libLabel) >= 0) {\n        bytecode = bytecode.replace(libLabel, hexAddress);\n      }\n    };\n\n    replace(libraryName);\n    replace(libraryHashPlaceholder(libraryName));\n  }\n\n  return bytecode;\n};\n\nvar findLinkReferences = function (bytecode) {\n  assert(typeof bytecode === 'string'); // find 40 bytes in the pattern of __...<36 digits>...__\n  // e.g. __Lib.sol:L_____________________________\n\n  var linkReferences = {};\n  var offset = 0;\n\n  while (true) {\n    var found = bytecode.match(/__(.{36})__/);\n\n    if (!found) {\n      break;\n    }\n\n    var start = found.index; // trim trailing underscores\n    // NOTE: this has no way of knowing if the trailing underscore was part of the name\n\n    var libraryName = found[1].replace(/_+$/gm, '');\n\n    if (!linkReferences[libraryName]) {\n      linkReferences[libraryName] = [];\n    }\n\n    linkReferences[libraryName].push({\n      // offsets are in bytes in binary representation (and not hex)\n      start: (offset + start) / 2,\n      length: 20\n    });\n    offset += start + 20;\n    bytecode = bytecode.slice(start + 20);\n  }\n\n  return linkReferences;\n};\n\nmodule.exports = {\n  linkBytecode: linkBytecode,\n  findLinkReferences: findLinkReferences\n};","map":{"version":3,"sources":["/home/codaruuu/Desktop/reactClient/remixclient/node_modules/solc/linker.js"],"names":["assert","require","keccak256","libraryHashPlaceholder","input","slice","linkBytecode","bytecode","libraries","librariesComplete","libraryName","lib","parsed","match","hexAddress","length","Error","Array","join","replace","name","truncatedName","libLabel","indexOf","findLinkReferences","linkReferences","offset","found","start","index","push","module","exports"],"mappings":"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","sourcesContent":["var assert = require('assert');\nvar keccak256 = require('js-sha3').keccak256;\n\nfunction libraryHashPlaceholder (input) {\n  return '$' + keccak256(input).slice(0, 34) + '$';\n}\n\nvar linkBytecode = function (bytecode, libraries) {\n  assert(typeof bytecode === 'string');\n  assert(typeof libraries === 'object');\n  // NOTE: for backwards compatibility support old compiler which didn't use file names\n  var librariesComplete = {};\n  for (var libraryName in libraries) {\n    if (typeof libraries[libraryName] === 'object') {\n      // API compatible with the standard JSON i/o\n      for (var lib in libraries[libraryName]) {\n        librariesComplete[lib] = libraries[libraryName][lib];\n        librariesComplete[libraryName + ':' + lib] = libraries[libraryName][lib];\n      }\n    } else {\n      // backwards compatible API for early solc-js versions\n      var parsed = libraryName.match(/^([^:]+):(.+)$/);\n      if (parsed) {\n        librariesComplete[parsed[2]] = libraries[libraryName];\n      }\n      librariesComplete[libraryName] = libraries[libraryName];\n    }\n  }\n\n  for (libraryName in librariesComplete) {\n    var hexAddress = librariesComplete[libraryName];\n    if (hexAddress.slice(0, 2) !== '0x' || hexAddress.length > 42) {\n      throw new Error('Invalid address specified for ' + libraryName);\n    }\n    // remove 0x prefix\n    hexAddress = hexAddress.slice(2);\n    hexAddress = Array(40 - hexAddress.length + 1).join('0') + hexAddress;\n\n    // Support old (library name) and new (hash of library name)\n    // placeholders.\n    var replace = function (name) {\n      // truncate to 37 characters\n      var truncatedName = name.slice(0, 36);\n      var libLabel = '__' + truncatedName + Array(37 - truncatedName.length).join('_') + '__';\n      while (bytecode.indexOf(libLabel) >= 0) {\n        bytecode = bytecode.replace(libLabel, hexAddress);\n      }\n    };\n\n    replace(libraryName);\n    replace(libraryHashPlaceholder(libraryName));\n  }\n\n  return bytecode;\n};\n\nvar findLinkReferences = function (bytecode) {\n  assert(typeof bytecode === 'string');\n  // find 40 bytes in the pattern of __...<36 digits>...__\n  // e.g. __Lib.sol:L_____________________________\n  var linkReferences = {};\n  var offset = 0;\n  while (true) {\n    var found = bytecode.match(/__(.{36})__/);\n    if (!found) {\n      break;\n    }\n\n    var start = found.index;\n    // trim trailing underscores\n    // NOTE: this has no way of knowing if the trailing underscore was part of the name\n    var libraryName = found[1].replace(/_+$/gm, '');\n\n    if (!linkReferences[libraryName]) {\n      linkReferences[libraryName] = [];\n    }\n\n    linkReferences[libraryName].push({\n      // offsets are in bytes in binary representation (and not hex)\n      start: (offset + start) / 2,\n      length: 20\n    });\n\n    offset += start + 20;\n\n    bytecode = bytecode.slice(start + 20);\n  }\n  return linkReferences;\n};\n\nmodule.exports = {\n  linkBytecode: linkBytecode,\n  findLinkReferences: findLinkReferences\n};\n"]},"metadata":{},"sourceType":"script"}